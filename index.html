<!DOCTYPE html>
<html lang="en-US">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="stylesheet" href="https://npmcdn.com/basscss@7.1.1/css/basscss.min.css">
    <title>automata, take 1</title>
    <meta name="description" content="">
    <meta name="author" content="Brian Zelip">
    <meta name="keywords" content="">
    <style>

      #automata {
        margin: 0 auto;
      }

      .row {
        line-height: .5;
      }

      .cell {
        height: 10px;
        width: 10px;
        display: inline-block;
        /*border-radius: 50%;*/
        box-sizing: border-box;
      }

      .inactive { background-color: red;}

      .active {
        background-color: #fff;
        border: 1px solid red;
      }

    </style>
  </head>

  <body>

    <main id="automata"></main>

    <script>

      const automata = document.getElementById('automata');
      const vw = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
      const vh = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);

      let rows = {
        create: function() {
          let row = document.createElement('div');
          automata.appendChild(row);
          row.id = 'r' + (automata.children.length - 1);
          row.classList.add('row');
        },
        numRowsPerViewport: ((Math.round(vh / 10)) - 1)
      }

      let cells = {
        grow: function() {
          let row = document.getElementById('r' + (automata.children.length - 1));
          for (let i=0; i<cells.numCellsPerRow; i++) {
            let cell = document.createElement('div');
            cell.classList.add('cell');
            cell.id = 'r' + (automata.children.length - 1) + 'c' + i;
            row.appendChild(cell);
          }
        },
        numCellsPerRow: ((Math.round(vw/10)) - 1),
        godMode: function() {
          function randomBinary() {
            let min = 0;
            let max = 1;
            return Math.floor(Math.random() * (max - min + 1)) + min;
          };
          let cells = document.querySelectorAll('#r' + (automata.children.length - 1) + ' > div');
          Array.from(cells).map(cell => cell.classList.add(randomBinary() ? 'active' : 'inactive'));
        },
        natureMode: function(ruleSet) {
          let previousCells = document.querySelectorAll('#r' + (automata.children.length - 2) + ' > div');
          let currentCells = document.querySelectorAll('#r' + (automata.children.length - 1) + ' > div');

          for (let i=0; i<currentCells.length; i++) {
            let self = currentCells[i];
            let prevSelf = previousCells[i];
            let prevNeighborLeft = previousCells[i - 1] || previousCells[previousCells.length - 1];
            let prevNeighborRight = previousCells[i + 1] || previousCells[0];

            self.classList.add(ruleSets[ruleSet][cells.neiborhoodScore(prevNeighborLeft, prevSelf, prevNeighborRight)]);
          }
        },
        isActive: function(cell) {
          return cell.classList.contains('active');
        },
        neiborhoodScore: function(prevLeft, prevSelf, prevRight) {
          let score = (cells.isActive(prevLeft) ? '1' : '0')
            + (cells.isActive(prevSelf) ? '1' : '0')
            + (cells.isActive(prevRight) ? '1' : '0');
          return score;
        }
      }

      let ruleSets = {
        "1": {
          "wolframSolution": [0, 0, 0, 0, 0, 0, 0, 1],
          "111": "inactive",
          "110": "inactive",
          "101": "inactive",
          "100": "inactive",
          "011": "inactive",
          "010": "inactive",
          "001": "inactive",
          "000": "active"
        },
        "7": {
          "wolframSolution": [0, 0, 0, 0, 0, 1, 1, 1],
          "111": "inactive",
          "110": "inactive",
          "101": "inactive",
          "100": "inactive",
          "011": "inactive",
          "010": "active",
          "001": "active",
          "000": "active"
        },
        "62": {
          "wolframSolution": [0, 0, 1, 1, 1, 1, 1, 0],
          "111": "inactive",
          "110": "inactive",
          "101": "active",
          "100": "active",
          "011": "active",
          "010": "active",
          "001": "active",
          "000": "inactive"
        },
        "90": {
          "wolframSolution": [0, 1, 0, 1, 1, 0, 1, 0],
          "111": "inactive",
          "110": "active",
          "101": "inactive",
          "100": "active",
          "011": "active",
          "010": "inactive",
          "001": "active",
          "000": "inactive"
        },
        "110": {
          "wolframSolution": [0, 1, 1, 0, 1, 1, 1, 0],
          "111": "inactive",
          "110": "active",
          "101": "active",
          "100": "inactive",
          "011": "active",
          "010": "active",
          "001": "active",
          "000": "inactive"
        },
        "numbersArr": ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", "54", "55", "56", "57", "58", "59", "60", "61", "62", "63", "64", "65", "66", "67", "68", "69", "70", "71", "72", "73", "74", "75", "76", "77", "78", "79", "80", "81", "82", "83", "84", "85", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184", "185", "186", "187", "188", "189", "190", "191", "192", "193", "194", "195", "196", "197", "198", "199", "200", "201", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "227", "228", "229", "230", "231", "232", "233", "234", "235", "236", "237", "238", "239", "240", "241", "242", "243", "244", "245", "246", "247", "248", "249", "250", "251", "252", "253", "254", "255", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", "54", "55", "56", "57", "58", "59", "60", "61", "62", "63", "64", "65", "66", "67", "68", "69", "70", "71", "72", "73", "74", "75", "76", "77", "78", "79", "80", "81", "82", "83", "84", "85", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184", "185", "186", "187", "188", "189", "190", "191", "192", "193", "194", "195", "196", "197", "198", "199", "200", "201", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "227", "228", "229", "230", "231", "232", "233", "234", "235", "236", "237", "238", "239", "240", "241", "242", "243", "244", "245", "246", "247", "248", "249", "250", "251", "252", "253", "254", "255"]
      }

      let dataScrapes = {
        getRuleNumbersArrary: function() {
          let sourceURL = 'http://atlas.wolfram.com/01/01/views/3/TableView.html';
          let ruleNumbers = document.querySelectorAll('.RuleNumber');
          let rnArray = [];
          let getRuleNumbers = function() {
            ruleNumbers.forEach((number) => {
             rnArray.push(number.innerHTML);
            });
            return rnArray;
          }
          console.log('getRuleNumbers()', getRuleNumbers())
          copy(getRuleNumbers());
        },
        getSolution: function() {
          let sourceURL = 'http://atlas.wolfram.com/01/01/1/01_01_106_1.html'//for example
          var obj = document.querySelector('body').innerText;
          return obj;
        }
      }

      let actOfGod = function() {
        rows.create();
        cells.grow();
        cells.godMode();
      }

      let actOfNature = function(ruleSet) {
        for (let i = 1; i < rows.numRowsPerViewport; i++) {
          rows.create();
          cells.grow();
          cells.natureMode(ruleSet);
        }
      }

      actOfGod();
      actOfNature(110);
      dataScrapes.scrapeSolution(90);
      // newRow.growCells(41);
      // console.log(typeof(newRow.growCells()))
      // console.log('newRow.create()', newRow.create());

      /*
        REFERENCES:
        - Child selectors, https://developer.mozilla.org/en-US/docs/Web/CSS/Child_selectors
        - Node.cloneNode(), https://developer.mozilla.org/en-US/docs/Web/API/Node/cloneNode
        - Array.from(), https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from
        - Math.random(), https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random#Getting_a_random_integer_between_two_values_inclusive
        ParentNode.children(), https://developer.mozilla.org/en-US/docs/Web/API/ParentNode/children
        - getElementById(), https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementById
        - Node.insertBefore(), https://developer.mozilla.org/en-US/docs/Web/API/Node/insertBefore
        - Node.firstChild, https://developer.mozilla.org/en-US/docs/Web/API/Node/firstChild
        - NodeList.forEach(), https://developer.mozilla.org/en-US/docs/Web/API/NodeList/forEach
        - #Objects and properties, https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Working_with_Objects#Objects_and_properties
        - Element.classList, https://developer.mozilla.org/en-US/docs/Web/API/Element/classList
        - Viewport width and height in js, http://stackoverflow.com/a/8876069/2145103
        -
      */

    </script>

  </body>

</html>
